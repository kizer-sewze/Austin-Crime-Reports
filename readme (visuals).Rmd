---
title: "Final Project"
author: "Seth"
date: "2023-10-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown


```{r cars}
install.packages("RSocrata")
library(RSocrata)
library(dplyr)
library(ggplot2)
crime <- read.socrata("https://data.austintexas.gov/Public-Safety/Crime-Reports/fdj4-gpfu")
```

## Code



```{r crime}
crime <- crime %>% filter(grepl("2023", occ_date))
nrow(crime) # 1007 (two "pages")
glimpse(crime)
class(crime$crime_type[1]) # POSIXlt
crime$zip_code <- factor(crime$zip_code)
crime$council_district <- factor(crime$council_district)
```

## Plots


```{r plots}
crime %>% filter(!is.na(council_district)) %>% mutate(family_violence = tolower(family_violence)) %>%
  ggplot(aes(x = council_district , y = family_violence, color = family_violence)) +
  geom_bar(stat = "identity", aes(fill = family_violence)) +
  labs(x = "Council District", y = "Proportion of Family Crimes") +
  ggtitle("Proportion of Family Crimes by Zip Code") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

crime %>% filter(!is.na(council_district)) %>% 
  ggplot(aes(x = longitude, y = latitude, color = council_district)) +
  geom_point(size = 0.1) +
  labs(x = "longitude", y = "latitude") +
  ggtitle("Austin Crimes by Council District") +
  theme_minimal()
```


